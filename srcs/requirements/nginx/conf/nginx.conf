# Set the user and group that the Nginx worker processes will run as
user www-data;
# (default block, required by Nginx)
events { }

http {
    # Load MIME types for file extensions (e.g., .html, .css)
    include mime.types;

    # Enable modern TLS protocols for SSL connections
    ssl_protocols TLSv1.2 TLSv1.3;

    # Path to the SSL certificate (self-signed or issued)
    ssl_certificate /certificate/sarif.crt;

    # Path to the corresponding private key
    ssl_certificate_key /certificate/sarif.key;


    server {
        # Listen on port 443 with SSL enabled
        listen 443 ssl;

        # Set the domain name(s) this server block will respond to
        server_name sarif.42.fr www.sarif.42.fr;

        # Define the root location for serving static files
        root /var/www/html;

        # Default file(s) to look for when a directory is requested
        index index.php index.html index.htm;

        # Process PHP files via FastCGI (sent to a container named 'wordpress' on port 9000)
        location ~ \.php$ {
            include fastcgi_params;  # Load default FastCGI parameters

            # Send requests to PHP-FPM listening inside the 'wordpress' container
            fastcgi_pass wordpress:9000;

            # Default script index file
            fastcgi_index index.php;

            # Full path to the script being executed
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;

            # Optional: pass additional path info if available
            fastcgi_param PATH_INFO $fastcgi_path_info;
        }
    }
    error_log /var/log/nginx/error.log;
    access_log /var/log/nginx/access.log;
}
